<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MobileApp.Views.TransactionsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:MobileApp.ViewModels">

    <Grid RowDefinitions="Auto, *"
          Padding="20">

        <!-- Ð’ÐµÑ€Ñ…Ð½Ñ Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð° -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Spacing="10">

                <Label Text="Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ñ–Ñ—"
                       FontSize="28"
                       HorizontalOptions="Center"/>

                <Button Text="ÐžÐ½Ð¾Ð²Ð¸Ñ‚Ð¸"
                        BackgroundColor="#ddd"
                        Command="{Binding LoadCommand}"/>

                <Entry Placeholder="ÐÐ°Ð·Ð²Ð°"
                       Text="{Binding NewName}"/>

                <Entry Placeholder="Ð¡ÑƒÐ¼Ð°"
                       Keyboard="Numeric"
                       Text="{Binding NewSum}"/>

                <Picker Title="ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ñ–Ñ"
                        ItemsSource="{Binding Categories}"
                        SelectedItem="{Binding SelectedCategory}"
                        ItemDisplayBinding="{Binding Name}"/>

                <Button Text="Ð”Ð¾Ð´Ð°Ñ‚Ð¸"
                        Command="{Binding AddTransactionCommand}"/>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Transactions}">
            <CollectionView.ItemTemplate>
                <DataTemplate>

                    <Grid Padding="10"
                          ColumnDefinitions="*, Auto, Auto"
                          ColumnSpacing="12">

                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="{Binding Name}"
                                   FontSize="16"/>
                            <Label Text="{Binding Sum}"
                                   FontAttributes="Bold"/>
                            <Label Text="ÐŸÑ–ÑÐ»Ñ Ð¿Ð¾Ð´Ð°Ñ‚ÐºÑƒ:"
                                   FontSize="12"/>
                            <Label Text="{Binding SumAfterTax}"
                                   FontSize="12"
                                   TextColor="Gray"/>
                        </VerticalStackLayout>

                        <!-- Edit -->
                        <Button Grid.Column="1"
                                Text="âœŽ"
                                WidthRequest="36"
                                HeightRequest="36"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:TransactionsViewModel}}, Path=EditTransactionCommand}"
                                CommandParameter="{Binding .}"/>

                        <!-- Delete -->
                        <Button Grid.Column="2"
                                Text="ðŸ—‘"
                                TextColor="Red"
                                WidthRequest="36"
                                HeightRequest="36"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:TransactionsViewModel}}, Path=DeleteTransactionCommand}"
                                CommandParameter="{Binding Id}"/>
                    </Grid>

                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>
